# –ë—ã—Å—Ç—Ä–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –¥–æ–ª–≥–∞—Ö

## –ü—Ä–æ–≤–µ—Ä–∫–∞ 1: –°—É—â–µ—Å—Ç–≤—É—é—Ç –ª–∏ —Ç–∞–±–ª–∏—Ü—ã?

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ MySQL:
```sql
USE all_shops;
SHOW TABLES LIKE '%debt%';
```

**–ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü –ù–ï–¢** ‚Üí –ü–µ—Ä–µ–π–¥–∏—Ç–µ –∫ –®–∞–≥—É 2
**–ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü—ã –ï–°–¢–¨** ‚Üí –ü–µ—Ä–µ–π–¥–∏—Ç–µ –∫ –®–∞–≥—É 3

---

## –®–∞–≥ 2: –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã

### –í–∞—Ä–∏–∞–Ω—Ç A: –ß–µ—Ä–µ–∑ –º–∏–≥—Ä–∞—Ü–∏—é (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
cd backend_nestjs
npm run migration:run
```

### –í–∞—Ä–∏–∞–Ω—Ç B: –í—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ SQL
```bash
# Windows PowerShell
mysql -u root -p all_shops < scripts/create-debts-tables.sql

# –ò–ª–∏ —á–µ—Ä–µ–∑ MySQL Workbench:
# –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª scripts/create-debts-tables.sql –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –µ–≥–æ
```

---

## –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ backend

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ backend:
   ```bash
   cd backend_nestjs
   npm run start:dev
   ```

2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–æ–∑–¥–∞—Ç—å –¥–æ–ª–≥ —á–µ—Ä–µ–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å backend. –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
   ```
   üì• POST /customer-debts: { ... }
   üìù –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–ª–≥–∞ –∫–ª–∏–µ–Ω—Ç–∞: { ... }
   ‚úÖ –î–æ–ª–≥ –∫–ª–∏–µ–Ω—Ç–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω: { id: 1, ... }
   ```

4. –ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫—É:
   - `Table 'all_shops.customer_debts' doesn't exist` ‚Üí –¢–∞–±–ª–∏—Ü—ã –Ω–µ —Å–æ–∑–¥–∞–Ω—ã (–®–∞–≥ 2)
   - `Foreign key constraint fails` ‚Üí –ü—Ä–æ–≤–µ—Ä—å—Ç–µ shopId –∏ userId
   - –î—Ä—É–≥–∏–µ –æ—à–∏–±–∫–∏ ‚Üí –°–º–æ—Ç—Ä–∏—Ç–µ –¥–µ—Ç–∞–ª–∏ –≤ –ª–æ–≥–∞—Ö

---

## –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –±–∞–∑–µ

```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ–ª–≥–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤
SELECT * FROM customer_debts ORDER BY createdAt DESC LIMIT 10;

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ–ª–≥–∏ —Ñ–∏—Ä–º–∞–º
SELECT * FROM supplier_debts ORDER BY createdAt DESC LIMIT 10;
```

---

## –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–ª–æ

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ backend —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö `all_shops` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ `.env`:
   ```
   DB_HOST=localhost
   DB_PORT=3306
   DB_USERNAME=root
   DB_PASSWORD=
   DB_DATABASE=all_shops
   ```
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü

---

## –¢–µ—Å—Ç —á–µ—Ä–µ–∑ API

### –°–æ–∑–¥–∞—Ç—å –¥–æ–ª–≥ –∫–ª–∏–µ–Ω—Ç–∞:
```bash
curl -X POST http://localhost:3000/customer-debts \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "customerName": "–¢–µ—Å—Ç",
    "amount": 100,
    "description": "–¢–µ—Å—Ç–æ–≤—ã–π –¥–æ–ª–≥",
    "debtDate": "2026-01-24",
    "shopId": 1
  }'
```

–ï—Å–ª–∏ –ø–æ–ª—É—á–∏—Ç–µ –æ—à–∏–±–∫—É - —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –µ—ë –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤—ã—à–µ.
